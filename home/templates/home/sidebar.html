<aside id="qeyd-sidebar" style="position:fixed; left:0; top:0; bottom:0; width:260px; background:linear-gradient(180deg,#044f8a,#033a66); border-right:1px solid rgba(0,0,0,0.06); padding:20px; box-shadow:2px 0 18px rgba(2,24,47,0.12); z-index:60; overflow:auto;">
    <div style="display:flex; flex-direction:column; gap:16px; height:100%;">
        <a href="{% url 'welcome' %}" style="text-decoration:none; color:inherit; display:flex; align-items:center; gap:12px;">
            <!-- Inline SVG note icon (used as logo). If you later add a static file at /static/home/note-icon.svg the browser will use it as favicon via head link. -->
            <div style="width:44px; height:44px; border-radius:10px; background:rgba(255,255,255,0.06); display:flex; align-items:center; justify-content:center;">
                <svg width="28" height="28" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false">
                    <rect x="2" y="3" width="14" height="18" rx="2" fill="#044f8a" />
                    <path d="M16.5 3.5l4 4L10 18l-4 1 1-4L16.5 3.5z" fill="#ffffff" />
                </svg>
            </div>
            <div style="font-weight:900; color:#ffffff; font-size:18px; letter-spacing:0.2px">QeydLab</div>
        </a>

        <nav style="margin-top:8px; display:flex; flex-direction:column; gap:8px;">
            <a href="{% url 'menu_page' %}" style="display:flex; align-items:center; padding:10px 12px; border-radius:8px; color:#eaf6ff; text-decoration:none; font-weight:700; background:transparent">Media</a>
            
            <div>
                <!-- Customers toggle (acts like Administrator) -->
                <a href="#" id="customersToggleLink" style="display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border-radius:8px; color:#e8f6ff; font-weight:700; text-decoration:none; background:transparent">
                    <span>Müştərilər</span>
                    <span id="customersAccordionIcon" style="font-size:12px; transition:transform 0.2s;">►</span>
                </a>
                <div id="customersMenu" style="display:none; margin-top:8px; display:flex; flex-direction:column; gap:6px; padding-left:6px;">
                    <a href="{% url 'notes_list' %}" style="padding:8px 10px; border-radius:8px; color:#dbeeff; text-decoration:none; background:transparent">Yaradılan qeydlər</a>
                </div>
            </div>

            <div>
                <!-- Administrator section: keep toggle behavior but remove the triangle for a cleaner look -->
                <a href="#" id="adminToggleLink" style="display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border-radius:8px; color:#eaf6ff; text-decoration:none; font-weight:700; background:transparent">
                    <span>Administrator</span>
                    <span id="adminAccordionIcon" style="font-size:12px; transition:transform 0.2s;">►</span>
                </a>
                <div id="adminMenu" style="display:none; margin-top:8px; display:flex; flex-direction:column; gap:6px; padding-left:6px;">
                    <a href="{% url 'users_list' %}" style="padding:8px 10px; border-radius:8px; color:#dbeeff; text-decoration:none;">Userlər</a>
                </div>
            </div>
        </nav>

        <div style="margin-top:auto; padding-top:12px; border-top:1px solid rgba(255,255,255,0.06);">
            <div style="font-size:12px; color:rgba(255,255,255,0.7);">Logged as</div>
            <div style="font-weight:700; color:#ffffff; margin-top:6px">{{ request.user.username|default:request.session.username|default:'Qonaq' }}</div>
        </div>
    </div>
</aside>

<style>
    /* main content shifts to make room for the fixed sidebar (restored to original compact behavior) */
    .main-with-sidebar { margin-left: 280px; width: calc(100% - 300px); padding: 18px 20px; box-sizing: border-box; }
    .main-with-sidebar .box { max-width: none; width:100%; }
    @media (max-width:900px){
        #qeyd-sidebar{ position:relative; width:100%; height:auto; box-shadow:none; border-right:none }
        .main-with-sidebar{ margin-left:0; width:100%; padding:12px }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function(){
        const toggleLink = document.getElementById('adminToggleLink');
        const adminMenu = document.getElementById('adminMenu');
        const adminIcon = document.getElementById('adminAccordionIcon');

        const customersToggle = document.getElementById('customersToggleLink');
        const customersMenu = document.getElementById('customersMenu');
        const customersIcon = document.getElementById('customersAccordionIcon');

        function setupAccordion(toggle, menu, icon) {
            if (toggle && menu && icon) {
                toggle.addEventListener('click', function(e) {
                    e.preventDefault();
                    const isOpen = menu.style.display === 'flex';
                    menu.style.display = isOpen ? 'none' : 'flex';
                    icon.textContent = isOpen ? '►' : '▼';
                });

                // Open menu if a child link is active
                if (menu.querySelector('a[href="' + window.location.pathname + '"]')) {
                    menu.style.display = 'flex';
                    icon.textContent = '▼';
                }
            }
        }

        setupAccordion(adminToggleLink, adminMenu, adminIcon);
        setupAccordion(customersToggleLink, customersMenu, customersIcon);
    });
</script>
